#define LINK_LENGTH 5
#define MAX_LENGTH 1000

//8x14
char ninja[] = {0x0,0x99,0xd0,0x0,0x29,0x22,0x2a,0x0,0x2,0x98,0x88,0x0,0x29,0x8b,0x8b,0x0,0x9,0x98,0x8d,0x8,0x0,0x99,0xd0,0xd,0x0,0x9,0x7,0xd,0x0,0x99,0x70,0xd0,0x9,0x97,0x9d,0x0,0x9c,0x79,0x9d,0x0,0x8,0xc9,0x9d,0x0,0xb,0xb2,0xbc,0x0,0x9,0x0,0xd,0x0,0x9,0x0,0xd,0x0};
char ninja2[] = {0x0,0x33,0xf0,0x0,0x3,0x33,0x3f,0x0,0xb,0x8b,0x8f,0x0,0x8,0x88,0x8f,0x0,0x0,0x33,0xf0,0x0,0x0,0x3,0x0,0x0,0x0,0x33,0x3f,0x0,0xf,0x33,0x33,0xf0,0xf,0x33,0x93,0xf,0x77,0x77,0x98,0xf0,0x80,0xcc,0x9c,0x0,0x0,0xc0,0xc,0x0,0x0,0xc0,0xc,0x0,0x0,0xc0,0xc,0x0};
char kick1[] = {0x0,0x3,0x3f,0x0,0x0,0x33,0x33,0xf0,0x0,0xb8,0xb8,0xf0,0x0,0x88,0x88,0xf0,0x0,0x3,0x3f,0x0,0x0,0x0,0x30,0x0,0x0,0x3,0x3f,0x0,0x0,0x33,0x33,0xf0,0x3,0x3f,0x33,0x9f,0x77,0xff,0x77,0x93,0xff,0xfc,0xcc,0x93,0xf,0xc0,0x0,0xc0,0x0,0xc0,0x0,0xc0,0x0,0xc0,0x0,0xc0};
char kick2[] = {0x0,0x3,0x3f,0x0,0x0,0x33,0x33,0xf0,0x0,0xb8,0xb8,0xf0,0x0,0x88,0x88,0xf0,0x0,0x3,0x3f,0xf0,0x0,0x0,0x3f,0xf0,0x0,0x3,0xff,0x0,0x0,0x3f,0xff,0xf0,0x3,0xff,0xf3,0x9f,0x7f,0xff,0x77,0x93,0xff,0xff,0xcc,0x93,0xf,0xf0,0x0,0xc0,0x0,0xc0,0x0,0xc0,0x0,0xc0,0x0,0xc0};
char kick3[] = {0x0,0x3,0x3f,0x0,0x0,0x33,0x33,0xf0,0x0,0xb8,0xb8,0xf0,0x0,0x88,0x88,0xf0,0x0,0x3,0x3f,0x20,0x0,0x0,0x32,0x20,0x0,0x3,0x20,0x0,0x0,0x32,0x2,0xf0,0x3,0x20,0x3,0x9f,0x72,0x0,0x77,0x93,0xf0,0x2,0xcc,0x93,0x0,0xf0,0x0,0xc0,0x0,0xc0,0x0,0xc0,0x0,0xc0,0x0,0xc0};
char kick4[] = {0x0,0x3,0x3f,0x0,0x0,0x33,0x33,0xf0,0x0,0xb8,0xb8,0xf2,0x0,0x88,0x88,0x20,0x0,0x23,0x32,0x20,0x2,0x0,0x32,0x20,0x0,0x3,0x20,0x2,0x2,0x32,0x2,0x20,0x3,0x20,0x3,0x9f,0x72,0x0,0x22,0x93,0xf0,0x2,0xcc,0x92,0x0,0xf0,0x0,0xc0,0x0,0xc0,0x20,0xc0,0x0,0xc0,0x0,0xc0};
char kick5[] = {0x2,0x3,0x3f,0x0,0x0,0x32,0x23,0x20,0x2,0x28,0xb8,0xf2,0x0,0x28,0x28,0x20,0x0,0x23,0x32,0x20,0x2,0x2,0x32,0x20,0x20,0x3,0x20,0x2,0x2,0x32,0x2,0x20,0x3,0x20,0x3,0x92,0x72,0x0,0x22,0x93,0xf0,0x2,0x2c,0x92,0x0,0x20,0x0,0xc0,0x2,0xc0,0x20,0x20,0x0,0xc0,0x0,0xc0};
	
//4x10
char hook[] = {0x6,0x6,0x6,0x96,0x0,0x90,0x6,0x96,0x6,0x6,0x6,0x96,0x0,0x90,0x0,0x9,0x90,0x9,0x9,0x90};
//8x3
char arrow[] = {0x80,0x80,0x0,0xc0,0x8,0x48,0x44,0x4c,0x80,0x80,0x0,0xc0};
//32x8
char gui[] = {0x2,0x32,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x23,0x20,0x23,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x32,0x32,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x23,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x32,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x23,0x23,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x32,0x2,0x32,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x23,0x20};
//4x55
char guichr[] = {0x11,0x16,0x16,0x16,0x16,0x16,0x16,0x16,0x11,0x16,0x66,0x16,0x66,0x16,0x66,0x16,0x66,0x16,0x66,0x16,0x11,0x16,0x66,0x16,0x11,0x16,0x16,0x66,0x11,0x16,0x11,0x16,0x66,0x16,0x61,0x16,0x66,0x16,0x11,0x16,0x16,0x16,0x16,0x16,0x11,0x16,0x66,0x16,0x66,0x16,0x11,0x16,0x16,0x66,0x11,0x16,0x66,0x16,0x11,0x16,0x11,0x16,0x16,0x66,0x11,0x16,0x16,0x16,0x11,0x16,0x11,0x16,0x66,0x16,0x66,0x16,0x66,0x16,0x66,0x16,0x11,0x16,0x16,0x16,0x11,0x16,0x16,0x16,0x11,0x16,0x11,0x16,0x16,0x16,0x11,0x16,0x66,0x16,0x11,0x16,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x66};
//20x15
char pressA[] = {0x2,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x0,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x20,0x21,0x11,0x21,0x21,0x21,0x11,0x22,0x12,0x21,0x20,0x21,0x21,0x21,0x12,0x21,0x12,0x21,0x22,0x12,0x20,0x21,0x11,0x21,0x22,0x21,0x22,0x22,0x12,0x21,0x20,0x21,0x22,0x21,0x22,0x21,0x11,0x21,0x22,0x12,0x20,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x20,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x20,0x22,0x22,0x22,0x21,0x11,0x11,0x22,0x22,0x22,0x20,0x22,0x22,0x22,0x11,0x11,0x11,0x12,0x22,0x22,0x20,0x22,0x22,0x22,0x11,0x22,0x22,0x12,0x22,0x22,0x20,0x22,0x22,0x22,0x11,0x22,0x22,0x12,0x22,0x22,0x20,0x22,0x22,0x22,0x11,0x11,0x11,0x12,0x22,0x22,0x20,0x22,0x22,0x22,0x11,0x11,0x11,0x12,0x22,0x22,0x20,0x22,0x22,0x22,0x11,0x22,0x22,0x12,0x22,0x22,0x20,0x2,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x0};
//32x16
char grass[] = {0x0,0x50,0x0,0x0,0x0,0x0,0x5,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xdd,0xd0,0x50,0x0,0x0,0x0,0x0,0x5,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xd,0xd0,0x50,0x0,0x0,0x0,0x0,0x5,0x0,0xd,0xd0,0x0,0x0,0x0,0x0,0x0,0x0,0x50,0x50,0x0,0x0,0x0,0x0,0x5,0x0,0xdd,0xd0,0x0,0x0,0x0,0x0,0xdd,0xdd,0x5,0x50,0x0,0x0,0x0,0x0,0x5,0x0,0xd0,0x0,0x0,0x0,0x0,0x0,0xd,0xd0,0x0,0x50,0x0,0xd,0xd0,0x0,0x5,0x5,0x0,0x0,0x0,0x5,0x5,0x0,0x0,0x0,0x0,0x55,0x0,0xdd,0x0,0x0,0x55,0x50,0xd0,0x0,0x0,0x5,0x50,0xdd,0x0,0x0,0x0,0x55,0xd,0xd0,0x0,0x0,0x55,0x0,0xdd,0x0,0xd0,0x5,0x0,0xd,0xd0,0x0,0x0,0x55,0x50,0x0,0x0,0x0,0x55,0x0,0xd,0x0,0xdd,0x5,0x0,0x0,0xd0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0xd,0xd5,0x0,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x5,0x0,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x5,0x50,0x0,0x0,0x0,0x5,0x55,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x5,0x50,0x0,0x0,0x0,0x5,0x55,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x5,0x50,0x0,0x0,0x0,0x5,0x50,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x5,0x50,0x0,0x0,0x0,0x5,0x50,0x0,0x0,0x0,0x0,0x55,0x0,0x0,0x0,0x0,0x5,0x50,0x0,0x0,0x0};
//char sky[] = {0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0xaa,0xa8,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0xaa,0xaa,0xaa,0xa8,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0xaa,0xaa,0xaa,0xaa,0xa8,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0xaa,0xa8,0x88,0x88,0x8a,0xaa,0xaa,0xaa,0xaa,0x88,0x88,0x88,0x88,0x88,0xaa,0xaa,0xaa,0xaa,0xaa,0x88,0x88,0x88,0x8a,0x88,0x88,0x88,0x88,0x88,0x78,0x7a,0xaa,0xaa,0xaa,0xaa,0xaa,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x8a,0x78,0x87,0x87,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x78,0x78,0x78,0x78,0x78,0x7a,0xaa,0x87,0x77,0x77,0x77,0x7a,0xaa,0xa7,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0xaa,0xaa,0xa7,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0x77,0xa7,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0xb7,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0x7b,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb,0xbb};
//32x32rle
char tittleScreen[] = {0x7e,0x0,0x7e,0x0,0x24,0x0,0x82,0x10,0xf,0x0,0x82,0x1,0x10,0x0,0x82,0x10,0xf,0x0,0x82,0x1,0x7,0x0,0x82,0x5,0x2,0x55,0x6,0x0,0x82,0x10,0x5,0x0,0x83,0x5,0x59,0x2,0x99,0x84,0xb5,0x0,0xaa,0x3,0x0,0x82,0x1,0x5,0x0,0x82,0xaa,0x3,0x22,0x85,0x2b,0xa,0x0,0x22,0x2,0x0,0x83,0xb5,0x5b,0x3,0x0,0x82,0xa,0x4,0x99,0x83,0x22,0x20,0x4,0x0,0x84,0x9,0x99,0x55,0x2,0x0,0x82,0x5,0x4,0x88,0x84,0x99,0xb2,0x20,0x3,0x0,0x2,0xbb,0x8d,0xb5,0xb0,0x0,0xb,0x8b,0x88,0xb8,0x88,0x9b,0xb0,0x2,0x20,0x3,0x0,0x2,0x99,0x84,0x50,0x0,0xb,0x3,0x88,0x86,0x89,0x99,0xb0,0x0,0x2,0x2,0x0,0x85,0xb,0xbb,0xb9,0x50,0x2,0x0,0x4,0x99,0x83,0x9b,0xb0,0x5,0x0,0x84,0x9,0x99,0x95,0x2,0x0,0x82,0x9,0x3,0x99,0x83,0xb9,0xb0,0x6,0x0,0x2,0x99,0x82,0x55,0x2,0x0,0x82,0x99,0x3,0x9b,0x7,0x0,0x82,0x9,0x2,0x99,0x84,0x55,0xbb,0x99,0x2,0xb9,0x82,0xb0,0x3,0x0};
char screenOfDeath[] = {0x7,0x0,0x2,0x11,0xd,0x0,0x4,0x11,0xb,0x0,0x6,0x11,0x9,0x0,0x82,0x1,0x6,0x11,0x82,0x10,0x8,0x0,0x8,0x11,0x7,0x0,0x82,0x1,0x8,0x11,0x82,0x10,0x6,0x0,0x82,0x1,0x8,0x11,0x82,0x10,0x6,0x0,0xa,0x11,0x6,0x0,0x4,0x11,0x83,0x19,0x91,0x4,0x11,0x5,0x0,0x82,0x1,0x4,0x11,0x85,0x19,0x91,0x12,0x21,0x2,0x11,0x82,0x10,0x4,0x0,0x82,0x1,0x4,0x11,0x85,0x19,0x92,0x21,0x12,0x2,0x11,0x82,0x10,0x4,0x0,0x82,0x1,0x4,0x11,0x84,0x12,0x21,0x12,0x3,0x11,0x82,0x10,0x5,0x0,0x3,0x11,0x82,0x19,0x2,0x99,0x83,0x91,0x22,0x2,0x11,0x6,0x0,0x4,0x11,0x83,0x1c,0xc1,0x4,0x11,0x6,0x0,0x82,0x1,0x3,0x11,0x83,0x1c,0xc1,0x3,0x11,0x82,0x10,0x6,0x0,0x82,0x1,0x3,0x11,0x83,0x1c,0xc1,0x3,0x11,0x82,0x10,0x7,0x0,0x3,0x11,0x83,0x1c,0xc1,0x3,0x11,0x8,0x0,0x82,0x1,0x2,0x11,0x83,0x1c,0xc1,0x2,0x11,0x82,0x10,0x9,0x0,0x2,0x11,0x83,0x1c,0xc1,0x2,0x11,0xb,0x0,0x85,0x11,0x1c,0xc1,0x11,0xd,0x0,0x83,0x1c,0xc1,0xe,0x0,0x83,0xf,0xf0,0xe,0x0,0x83,0xf,0xf0,0xe,0x0,0x83,0xf,0xf0,0xd,0x0,0x82,0xa,0x2,0xaa,0x82,0xa0,0xb,0x0,0x83,0xa,0xa8,0x2,0x88,0x83,0x8a,0xaa,0x9,0x0,0x83,0xa,0xa8,0x5,0x88,0x82,0xa0,0x7,0x0,0x83,0xa,0xa8,0x6,0x88,0x84,0x8a,0xaa,0xa0,0x2,0x0,0x3,0xaa,0x82,0xa8,0x9,0x88,0x82,0x8a,0x2,0xaa,0x30,0x88};
char screenOfWin[] = {0xc,0x0,0x82,0xa,0x2,0x0,0x82,0xb,0xc,0x0,0x82,0xa,0xf,0x0,0x82,0xaa,0x6,0x0,0x2,0xc9,0x85,0xd0,0x0,0x1,0x11,0x3,0x0,0x82,0xaa,0x5,0x0,0x86,0xc,0x9c,0x99,0x9d,0x1,0x3,0x11,0x2,0x0,0x82,0xa0,0x3,0x0,0x85,0x2,0x0,0xc,0xc2,0x2,0x22,0x5,0x11,0x83,0xa,0xa0,0x3,0x0,0x85,0x20,0x22,0xc,0x28,0x2,0x88,0x5,0x11,0x82,0x1a,0x6,0x0,0x83,0x22,0x88,0x2,0x8b,0x5,0x11,0x82,0xaa,0x5,0x0,0x83,0x22,0xc,0x3,0x88,0x4,0x11,0x84,0x1a,0xa1,0x10,0x3,0x0,0x85,0x22,0x0,0xc,0x99,0x2,0x88,0x3,0x11,0x85,0x61,0xaa,0x11,0x10,0x5,0x0,0x82,0xc,0x2,0x99,0x82,0x9d,0x3,0x11,0x83,0x86,0xa1,0x2,0x11,0x6,0x0,0x84,0xc9,0x99,0x9d,0x2,0x11,0x84,0x1d,0x88,0x61,0x2,0x11,0x6,0x0,0x84,0x9,0x99,0xd1,0x2,0x11,0x83,0xd6,0x68,0x3,0x11,0x82,0x10,0x5,0x0,0x83,0x9,0xd1,0x2,0x11,0x83,0x19,0x96,0x4,0x11,0x82,0x10,0x5,0x0,0x87,0x9,0xd1,0x11,0x1d,0x99,0xd1,0x4,0x11,0x82,0x10,0x4,0x0,0x87,0xcc,0xc9,0x9d,0xdd,0xd9,0x9d,0x5,0x11,0x4,0x0,0x83,0xc,0xcc,0x4,0x99,0x82,0xd1,0x5,0x11,0x4,0x0,0x86,0xc9,0xcc,0xc9,0x99,0x9d,0x6,0x11,0x82,0x10,0x4,0x0,0x86,0x9d,0xc,0x9c,0x99,0xd1,0x6,0x11,0x82,0x10,0x3,0x0,0x87,0xc,0xd0,0xc,0xc9,0x99,0xd1,0x6,0x11,0x4,0x0,0x87,0x9,0xd0,0xc,0x9c,0x99,0xd1,0x5,0x11,0x82,0x10,0x4,0x0,0x87,0xcd,0x0,0xc,0xc9,0x99,0xd1,0x5,0x11,0x5,0x0,0x88,0x9d,0x0,0x2c,0x9c,0x99,0xd0,0x1,0x3,0x11,0x6,0x0,0x8a,0x9,0x82,0xc,0xc2,0x29,0xd0,0x0,0x1,0x11,0x8,0x0,0x86,0x88,0x4,0x42,0x24,0x40,0xb,0x0,0x83,0x20,0xc,0x2,0x0,0x82,0xd0,0xa,0x0,0x84,0x2,0x0,0xc,0x2,0x0,0x82,0xd0,0xc,0x0,0x82,0xc,0x2,0x0,0x82,0xd0,0xc,0x0,0x82,0xd,0x2,0x0,0x82,0xd0,0xc,0x0,0x82,0xd,0x2,0x0,0x82,0xd0,0xc,0x0,0x82,0xd,0x2,0x0,0x82,0xd0,0xc,0x0,0x82,0xd,0x2,0x0,0x82,0xd0,0xa,0x0};
//32x16rle
char sky[] = {0xa,0x88,0x83,0xaa,0xa8,0xd,0x88,0x3,0xaa,0x82,0xa8,0xb,0x88,0x4,0xaa,0x82,0xa8,0x7,0x88,0x83,0xaa,0xa8,0x2,0x88,0x82,0x8a,0x4,0xaa,0x5,0x88,0x5,0xaa,0x3,0x88,0x82,0x8a,0x5,0x88,0x83,0x78,0x7a,0x5,0xaa,0x7,0x87,0x83,0x8a,0x78,0x2,0x87,0x6,0xaa,0x5,0x78,0x84,0x7a,0xaa,0x87,0x3,0x77,0x84,0x7a,0xaa,0xa7,0x7,0x77,0x2,0xaa,0x82,0xa7,0xe,0x77,0x93,0xa7,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x7b,0x77,0x10,0xb7,0x10,0x7b,0x90,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0xbb,0xb7,0x11,0xbb,0x10,0xb0,0x10,0xb};
char grass2[] = {0x18,0x0,0x82,0x9,0x17,0x0,0x82,0xb,0x3,0x0,0x82,0x9,0x3,0x0,0x82,0x9,0x4,0x0,0x82,0x9,0x2,0x0,0x83,0xb,0x9,0x2,0x0,0x82,0x9,0x3,0x0,0x82,0x9,0x4,0x0,0x82,0x99,0x2,0x0,0x86,0xb,0x9,0x0,0x90,0x9,0x3,0x0,0x82,0x9,0x2,0xb,0x87,0x9,0x0,0x90,0x0,0xb,0xbb,0x2,0x9,0x8a,0x0,0x9,0x0,0xb0,0x0,0x9,0xb,0xb0,0x0,0x2,0x90,0x2,0x0,0x83,0xb,0x0,0x2,0x90,0x83,0x9,0x0,0x2,0xb0,0x82,0x9,0x2,0xb,0x2,0x9,0x83,0x90,0x0,0x2,0xb,0x8a,0x0,0x90,0x0,0x9,0x0,0xbb,0x0,0x9,0xb,0x2,0x0,0x82,0x9,0x2,0x0,0x88,0x90,0xb,0x0,0x90,0x0,0x9,0x0,0x2,0xb0,0xb2,0x9,0xb,0x0,0xb0,0x9,0x0,0x90,0x99,0xb,0x0,0x90,0xb,0x9,0x0,0xb0,0x0,0x9,0xb,0x0,0xb,0x9,0x0,0x9,0x0,0xb,0x0,0x90,0xbb,0x9,0x0,0xb0,0x0,0x9,0xb,0x0,0xb,0xb9,0x0,0x9,0x0,0xb,0x0,0x90,0xb,0x9,0x0,0xb0,0x0,0x99,0x2,0xb,0x8c,0xb0,0x90,0x0,0xb9,0x90,0xb,0x0,0x90,0xb,0x9,0x0,0x2,0xb0,0x8f,0x90,0xb,0x0,0xb0,0x9b,0x0,0xb0,0x90,0xb,0x0,0x90,0xb,0x9,0x0,0x2,0xb0,0x83,0x90,0xb,0x2,0x0,0x82,0x90,0x2,0xb0,0x88,0x99,0xb,0x0,0x90,0xb,0x9,0x0,0x2,0xb0,0x86,0x90,0xb,0x0,0x9,0x0,0x2,0xb0,0x81,0x9};

int jointsx[] = {64,63,62,60,56,50};
int jointsy[] = {8,16,24,32,40,48};
int jointsxlast[] = {64,63,62,60,56,50};
int jointsylast[] = {8,16,24,32,40,48};

int gravity = 1;
int key, prevkey, game, x, y, topx, topy, speedx, deltaspeedx, changedObject, position, scrollx;

void chartosprite(int x, int y, int n) {
	int i, j;

	for (i = 0; i < 2; i++)
		for (j = 0; j < 5; j++)
			gui[x + i + (y + j) * 16] = guichr[n * 10 + i + j * 2];
}

void printtosprite(int x, int y, int n) {
	int i;

	for (i = 4; i >= 0; i--) {
		chartosprite(x + i * 2, y, n % 10); 
		n = n / 10;
	}
}

void updateJoints() {
	int tempPos, i, deltax, deltay, length;
	jointsx[5] = x;
	jointsy[5] = y;
	jointsx[4] = topx - (topx - x) / 2;
	jointsx[3] = topx - (topx - x) / 3;
	jointsx[2] = topx - (topx - x) / 4;

	for (i = 1; i < 6; i++) {
		tempPos = jointsx[i];
		jointsx[i] = jointsx[i] + (jointsx[i] - jointsxlast[i]);
		jointsxlast[i] = tempPos;
		tempPos = jointsy[i];
		jointsy[i] = jointsy[i] + (jointsy[i] - jointsylast[i]);
		jointsx[i] = jointsx[i] + (topx - jointsx[i]) / 2;
		jointsy[i] = jointsy[i] + gravity;
		jointsylast[i] = tempPos;

		deltax = jointsx[i - 1] - jointsx[i];
		deltay = jointsy[i - 1] - jointsy[i];
		length = distance(jointsx[i - 1], jointsy[i - 1],jointsx[i],jointsy[i]);

		if (length == 0)
			length = 1;

		deltax = deltax / length;
		deltay = deltay / length;
		deltax = (deltax * (length - LINK_LENGTH)) / 2;
		deltay = (deltay * (length - LINK_LENGTH)) / 2;
		// расталкиваем точки в противоположных направлениях
		jointsx[i - 1] = jointsx[i - 1] - deltax;
		jointsy[i - 1] = jointsy[i - 1] - deltay;
		jointsx[i] = jointsx[i] + deltax;
		jointsy[i] = jointsy[i] + deltay;
	}

	jointsx[0] = topx;
	jointsy[0] = topy;
	x = jointsx[5];
	y = jointsy[5];
}

void drawRope() {
	int i;
	setcolor(0);

	for (i = 0; i < 5; i++)
		line(jointsx[i], jointsy[i], jointsx[i + 1], jointsy[i + 1]);

	updateJoints();
	setcolor(1);

	for (i = 0; i < 5; i++)
		line(jointsx[i], jointsy[i], jointsx[i + 1], jointsy[i + 1]);

	putsprite(1, x - 7, y - 4);
}

void changePosition() {
	int i, newObj, dist, ox, oy;

	if (changedObject) {
		changedObject = 0;
		setcolor(0);

		for (i = 0; i < 5; i++)
			line(jointsx[i], jointsy[i], jointsx[i + 1], jointsy[i + 1]);

		spritespeedx(1, 4);
		spritespeedy(1, -20);
		spritesetvalue(1, S_GRAVITY, 3);
	} else {
		dist = 128;
		newObj = 0;
		ox = spritegetvalue(1, S_X);
		oy = spritegetvalue(1, S_Y);

		for (i = 2; i <= 10; i++) {
			if (spritegetvalue(i, S_X) >= 0) {
				if ((spritegetvalue(i, S_X) - ox) < dist && (spritegetvalue(i, S_X) - ox) > 0) {
					newObj = i;
					dist = spritegetvalue(i, S_X) - ox;
				}

				if ((ox - spritegetvalue(i, S_X) + 4) < dist && (ox - spritegetvalue(i, S_X)) > 0) {
					newObj = i;
					dist = ox - spritegetvalue(i, S_X);
				}
			}
		}

		if (dist < 32 && spritegetvalue(1, S_Y) < 96) {
			changedObject = newObj;
			topx = spritegetvalue(changedObject, S_X) + 2;
			topy = spritegetvalue(changedObject, S_Y) + 10;
			spritesetvalue(1, S_GRAVITY, 0);
		}
	}
}

void addHook() {
	int i, l;

	for (i = 2; i <= 10; i++) {
		if (spritegetvalue(i, S_LIVES) <= 0) {
			l = random(12) + position / 25;

			if (l > 40)
				l = 40;

			putsprite(i, 127 + l, 0 - random(4));
			return;
		}
	}
}

void scrollscreen() {
	int i;

	if (spritegetvalue(1,S_X) > 60) {
		position++;

		if (position >= MAX_LENGTH)
			game = 0;

		printtosprite(3, 1, position);
		scroll(2);

		for (i = 0; i < 6; i++) {
			jointsx[i] = jointsx[i] - 2;
			jointsxlast[i] = jointsxlast[i] - 2;
			x = x - 2;
			topx = spritegetvalue(changedObject, S_X) + 2;
		}

		scrollx-=5;

		if (scrollx <= 0)
			scrollx = 32;

		for (i = 0; i < 5; i++) {
			spritesetvalue(16 + i, S_X, scrollx  + ((i * 32) - 32));
		}

		for (i = 2; i <= 10; i++) {
			if (spritegetvalue(i, S_X) > 120)
				return;
		}

		addHook();
	}
}

void kickAnimation(int time) {
	if (time > 900)
		getsprite(13, kick1);
	else if (time > 700)
		getsprite(13, kick2);
	else if (time > 500)
		getsprite(13, kick3);
	else if (time > 300)
		getsprite(13, kick4);
	else if (time > 100)
		getsprite(13, kick5);
	else
		spritesetvalue(13, S_LIVES, 0);
}

void update() {
	int i, sx;
	key = getkey();

	if (key & KEY_LEFT)
		topx = topx - 2;
	else if (key & KEY_RIGHT)
		topx = topx + 2;

	if (key & KEY_B && prevkey != KEY_B)
		changePosition();

	if (key & KEY_A && prevkey != KEY_A) {
		if (spritegetvalue(30, S_LIVES) > 0) {
			spritesetvalue(30, S_LIVES, 0);
			settimer(3, 1100);
			getsprite(13, kick1);
			putsprite(13, spritegetvalue(12, S_X), spritegetvalue(12, S_Y));
			spritesetvalue(12, S_LIVES, 0);
		}	
	}

	prevkey = key;

	if (changedObject) {
		x += speedx;
		speedx = speedx + deltaspeedx;

		if (speedx > 20)
			deltaspeedx = -3;

		if (speedx < -20)
			deltaspeedx = 3;
	}

	if (gettimer(0) == 0) {
		settimer(0, 5000);
		putsprite(12, 126, 12 + random(64));
		spritesetvalue(12, S_ANGLE, 0);
		spritespeedx(12, -16);
		spritespeedy(12, -32);
		spritesetvalue(12, S_GRAVITY, 4);
	}

	if (gettimer(1) == 0) {
		settimer(1, 12000 + random(6000));
		putsprite(11, -7, random(64));
		spritesetvalue(11, S_ANGLE, 0);
		spritespeedx(11, 12);
		spritespeedy(11, 0);
	}

	if (gettimer(2) == 0) {
		settimer(2, 150);
		spritesetvalue(11, S_ANGLE, spritegetvalue(11, S_ANGLE) + 4);
		spritesetvalue(11, S_Y, spritegetvalue(11, S_Y) + 1);
	}

	if (gettimer(3) > 0) {
		kickAnimation(gettimer(3));
	}

	if (spritegetvalue(12,S_LIVES)) {
		i = distance(spritegetvalue(1, S_X), spritegetvalue(1, S_Y), spritegetvalue(12, S_X), spritegetvalue(12, S_Y));

		if (i < 54) {
			spritesetvalue(30, S_LIVES, 1);
			if (i < 12)
				game = 0;
		} else
			spritesetvalue(30, S_LIVES, 0);
	}

	sx = spritegetvalue(11, S_X);

	if (spritegetvalue(11, S_LIVES))
		for (i = 0; i < 8; i++)
			if (getpixel(sx + i, spritegetvalue(11, S_Y) + 1) == 1) {
				changePosition();
				return;
			}
}

void onHookExit(int n) {
	if (spritegetvalue(n, S_X) < 0)
		spritesetvalue(n, S_LIVES,0);
}

void onNinjaExit() {
	if (spritegetvalue(1, S_Y) > 120)
		game = 0;
}

void onNinja2Exit() {
	spritesetvalue(12, S_LIVES,0);
	spritesetvalue(30, S_LIVES, 0);
}

void init() {
	int i;
	setbgcolor(0);
	clearscreen();
	game = 1;

	for (i = 2; i <= 10; i++) {
		getsprite(i,hook);
		putsprite(i, i * 18, 0 - random(4));
		spritespeedx(i, 0);
		spritespeedy(i, 0);
		spritesetvalue(i, S_WIDTH, 4);
		spritesetvalue(i, S_HEIGHT, 10);
		spritesetvalue(i, S_ON_EXIT_SCREEN, onHookExit);
	}

	x = jointsx[5];
	y = jointsy[5];
	topx = spritegetvalue(2, S_X) + 2;
	topy = 10;
	speedx = 0;
	deltaspeedx = 1;
	getsprite(1, ninja);
	putsprite(1, x, y);
	spritespeedx(1, 0);
	spritespeedy(1, 0);
	spritesetvalue(1, S_WIDTH, 8);
	spritesetvalue(1, S_HEIGHT, 14);
	spritesetvalue(1, S_GRAVITY, 0);
	spritesetvalue(1, S_ON_EXIT_SCREEN, onNinjaExit);
	getsprite(11, arrow);
	spritesetvalue(11, S_WIDTH, 8);
	spritesetvalue(11, S_HEIGHT, 3);
	getsprite(12, ninja2);
	spritesetvalue(12, S_WIDTH, 8);
	spritesetvalue(12, S_HEIGHT, 14);
	spritesetvalue(12, S_ON_EXIT_SCREEN, onNinja2Exit);
	getsprite(13, kick1);
	spritesetvalue(13, S_WIDTH, 8);
	spritesetvalue(13, S_HEIGHT, 14);
	spritesetvalue(13, S_SPEEDY, 8);

	for (i = 0; i < 5; i++) {
		getsprite(16 + i, grass);
		spritesetvalue(16 + i, S_WIDTH, 32);
		spritesetvalue(16 + i, S_HEIGHT, 16);
		spritesetvalue(16 + i, S_SPEEDX, 0);
		spritesetvalue(16 + i, S_SPEEDY, 0);
		spritesetvalue(16 + i, S_IS_SCROLLED, 0);
		putsprite(16 + i, i * 32, 112);
		putimagerle(sky, i * 32, 0, 32, 16);
		putimagerle(grass2, i * 32, 106, 32, 16);
	}

	getsprite(31, gui);
	spritesetvalue(31, S_WIDTH, 32);
	spritesetvalue(31, S_HEIGHT, 8);
	spritesetvalue(31, S_IS_SCROLLED, 0);
	putsprite(31, 2, 118);
	getsprite(30, pressA);
	spritesetvalue(30, S_WIDTH, 20);
	spritesetvalue(30, S_HEIGHT, 16);
	spritesetvalue(30, S_IS_SCROLLED, 0);
	putsprite(30, 54, 64);
	spritesetvalue(30, S_LIVES, 0);
	changedObject = 2;
	position = 0;
	printtosprite(3, 1, position);
	drawRope();
	settimer(0, 500);

	while (gettimer(0)) {
    }

	settimer(0, 5000);
	settimer(1, 8000);
}

void tittle() {
	int color;
	color = 1;
	setbgcolor(0);
	clearscreen();
	setimagesize(4);
	putimagerle(tittleScreen, 0, 0, 32, 32);
	gotoxy(3, 0);
	printf("The  scroll  was  stolen from your clan. Return it.  Use the hook and the sword.");
	gotoxy(4, 6);
	printf("press any key");
	settimer(0, 500);

	while (gettimer(0)) {
    }

	while (getkey() == 0) {
		if (gettimer(0) == 0) {
			settimer(0, 400);
			color = 1 - color;
			setcolor(color + 1);
			gotoxy(4, 6);
			printf("press any key");
		}
	}

	setimagesize(1);
}

void end() {
	setbgcolor(0);
	clearscreen();
	setimagesize(4);
	putimagerle(screenOfDeath, 0, 0, 32, 32);
	settimer(0, 1000);

	while (gettimer(0)) {
    }

	setcolor(1);
	setbgcolor(8);
	gotoxy(5, 14);
	printf("distance %d ", position);

	while (getkey() == 0) {
    }

	setimagesize(1);
}

void win() {
	setbgcolor(0);
	clearscreen();
	setimagesize(4);
	putimagerle(screenOfWin, 0, 0, 32, 32);
	setcolor(1);
	setbgcolor(0);
	gotoxy(10, 13);
	printf("You win!");
	settimer(0, 1000);

	while (gettimer(0)) {
    }

	while (getkey() == 0) {
    }

	setimagesize(1);
}

void main() {
	int i;
	tittle();

	while (1) {
		init();

		while (game) {
			scrollscreen();

			for (i = 0; i < 5; i++)
				putimagerle(sky, i * 32, 0, 32, 16);

			if (changedObject)
				drawRope();

			update();
			delayredraw();
		}

		for (i = 0; i < 32; i++)
			spritesetvalue(i, S_LIVES, 0);

		if (position >= MAX_LENGTH)
			win();
		else
			end();
	}
}